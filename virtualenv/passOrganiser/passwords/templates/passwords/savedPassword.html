{% extends 'passwords/main.html' %}

{% block content %} 

<!-- <div class="container">
  <div class="row">
    <div class="col align-self-start">
      One of three columns
    </div>
    <div class="col align-self-center">
      One of three columns
    </div>

     
  </div>
</div> -->

<div class="container">
  <div class="row">
  <div class="col align-self-start">
    <button type="button" class="btn btn-dark" id="saveChanges">SaveChanges</button>
  </div>

  </div>
    <h2> </h2>   
    <!-- <table id="PasswordTable">   -->
      <table class="table table-striped" id="PasswordTable">
        <thead>
          <tr>
            <th></th>
            <th>Site</th>
            <th>UserName</th>
            <th>Password</th>
            <th></th>
          </tr>
        </thead>

        

            <tbody>
              {% for i in list %}
              <tr>
                <td></td>
                <td> 
                  {{i.site}}
                  <!-- contenteditable="true" -->
                </td>
                <td> {{i.salt}}</td>
                <td>
                  <div class="savedPassField">
                    <input type="password" id="{{i.id}}" value={{i.encryptedPass}}>
                  </div>
                </td> 
                <td>
                  
                    <button onclick ="showPassword('{{i.id}}')">View</button>
                    <!-- <input class="btn btn-sm btn-light" type="submit" value="View"> -->

                </td>

              </tr>

              {% endfor %}

            </tbody>


        <!-- <tr>
          <td>Row1 cell1</td>
          <td>Row1 cell2</td>
        </tr>
        <tr>
          <td>Row2 cell1</td>
          <td>Row2 cell2</td>
        </tr>
        <tr>
          <td>Row3 cell1</td>
          <td>Row3 cell2</td>
        </tr> -->
    </table>
  <!-- </table>    -->
    </a>
    <form method="POST" action="">
      {% csrf_token %}
      <div class="text-center">
          <button type="button" class="btn btn-dark" onclick="addRow()">+</button>
      </div>
    </form>

    <script>
      function showPassword(id){
        var temp = document.getElementById(id); 
            if (temp.type === "password") { 
                temp.type = "text"; 
            } 
            else { 
                temp.type = "password"; 
            } 
      }
    </script>
  {% csrf_token %} 
    <script>
      
      function saveDetails(){
        console.log("Hello world")
        document.getElementById("myForm").submit();
      }
    </script>


<script type="text/javascript">
  $(document).ready(function() {
      var url = data.result.docs[i].source.enriched.url.url;
      $("#saveChanges").click(function() {
          $.ajax({
              url: "/save_details",
              type: "POST",
              dataType: "json",
              data: {
                  url: url,
                  csrfmiddlewaretoken: '{{ csrf_token }}'
                  },
              success : function(json) {
                  alert("Successfully sent the URL to Django");
              },
              error : function(xhr,errmsg,err) {
                  alert("Could not send URL to Django. Error: " + xhr.status + ": " + xhr.responseText);
              }
          });
      });
  });
</script>
    <!-- <script>
      function hidePassword(){
        var test = document.getElementById("passwordDisplay");
        test.textContent = test.textContent.replace(test.textContent,'*');
        console.log(test);
      }
      window.onload = hidePassword;
    </script> -->
<div class="form-group"> 
  <form id ="myForm" method = "POST">
    {% csrf_token %} 
    <script>
      function addRow(){
        
        var form = document.createElement("myForm")
        var table = document.getElementById("PasswordTable");  
        var rowTotal = table.rows.length; 
        var row = table.insertRow(-1); 
        var cell1 = row.insertCell(0)
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);

        cell2.innerHTML = '<input type ="text" class="form-control" id="site"  name="site">'
        cell3.innerHTML = '<input type ="text" class="form-control" id="username"  name="username">'
        cell4.innerHTML = '<input type ="text" class="form-control" id="password" name="password">'
        cell5.innerHTML = '<input class="btn btn-sm btn-light" onclick="saveDetails()" type="submit" value="Save">'

        // //var createClickHandler = editingStarted()
        
        //cell1.onclick = editingStarted()
        // cell1.addEventListener("click", editingStarted);
        
        //cell1.getElementByTagName("INPUT")[0].setAttribute("type", "button"); 
        

        
        // cell2.setAttribute('contenteditable', true);
        // // cell3.setAttribute('contenteditable', true);
        // cell2.innerText = "Does this work?"
        // var btn = document.createElement("BUTTON"); 
        // btn.className="btn btn-light btn-xl"
        // btn.innerText = "Save"

        //  row.appendChild(btn);
      }

    </script>
</form>
</div>

    <script>
      function editingStarted(){
      }
    </script>
    
  </div>
  
  </body>
  </html>

{% endblock %}

